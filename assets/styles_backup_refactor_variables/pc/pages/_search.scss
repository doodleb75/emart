@use "../../abstracts/functions" as *;
@use "../../abstracts/mixins";
@use "../../abstracts/variables";

// 검색 결과 페이지
.search-result-page {
    padding-top: rem(40);
    padding-bottom: rem(80);
    font-weight: 600;

    // 페이지 헤더
    .page-header {
        margin-top: rem(80);
        margin-bottom: rem(80);
        text-align: center;

        .search-result-title {
            font-size: variables.$font-size-lg;
            color: variables.$gray-700;
            line-height: 1.4;
            font-weight: 600;

            .keyword {
                color: variables.$system-info; // 강조 색상
            }
        }
    }

    // 리스트 보기 모드영역 컨테이너
    .search-top-area {
        display: flex;
        flex-direction: column;
        margin-bottom: rem(20);
        width: 100%;

        // 총 상품 수
        .total-count-row {
            padding-bottom: variables.$space-lg;
            border-bottom: 2px solid variables.$gray-700;
            font-size: variables.$font-size-md;
            color: variables.$gray-700;
            font-weight: 600;
            display: flex;
            align-items: center;

            .count {
                color: variables.$system-info;
                margin-left: variables.$space-xs;
            }
        }

        // 연관 검색어
        .related-keywords-row {
            display: flex;
            align-items: center;
            padding: rem(12) 0;
            margin: rem(12) 0;
            min-height: rem(48);
            font-size: rem(16);
            color: variables.$gray-700;
            letter-spacing: rem(-0.32);

            .label {

                color: variables.$gray-700;
                white-space: nowrap;
            }

            .divider-vertical {
                width: 1px;
                height: rem(12);
                background-color: variables.$gray-300;
                margin: 0 rem(20);
            }

            .keyword-list {
                display: flex;
                flex-wrap: wrap;
                gap: variables.$space-md;

                .keyword-item {
                    cursor: pointer;
                    color: variables.$gray-700;
                    letter-spacing: rem(-0.32);

                    &:hover {
                        text-decoration: underline;
                        color: variables.$system-info;
                    }
                }
            }
        }

        // 필터 및 정렬
        .filter-options-row {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            padding: rem(12) 0;
            margin: rem(12) 0;
            min-height: rem(48);

            .divider-vertical {
                width: 1px;
                height: rem(12);
                background-color: variables.$gray-300;
                margin: 0 variables.$space-md;
            }

            .filter-group {
                display: flex;
                align-items: center;
                gap: variables.$space-xs;
                font-size: variables.$font-size-md;
                color: variables.$gray-700;
                letter-spacing: rem(-0.32);

                a.filter-link-link {
                    display: flex;
                    align-items: center;
                    gap: rem(2);

                    &:hover {
                        color: variables.$black;
                    }

                    svg {
                        position: relative;
                        top: rem(-1);
                        width: rem(18);
                        height: rem(18);
                        margin-left: rem(2);
                    }
                }

                .text-blue {
                    color: variables.$system-info;

                    margin-left: rem(2);
                }
            }

            .checkbox-group {
                display: flex;
                align-items: center;
                gap: rem(20);
                margin-left: rem(20);

                custom-checkbox {
                    display: inline-flex;
                    align-items: center;

                    // 정렬 옵션 (랭킹순, 가격순 등)스타일 (상위 요소에 클래스가 있을 경우)
                    &.dark-label .label-text {
                        color: variables.$gray-700 !important;
                    }
                }

                .custom-checkbox-wrap {
                    display: inline-flex;
                    align-items: center;
                    gap: rem(6);
                    cursor: pointer;
                    user-select: none;
                    margin: 0; // margin 초기화

                    .custom-checkbox-input {
                        position: absolute;
                        opacity: 0;
                        width: 0;
                        height: 0;
                    }

                    .custom-checkbox-visual {
                        width: rem(18);
                        height: rem(18);
                        border: 1.5px solid variables.$gray-300;
                        border-radius: rem(2);
                        background-color: variables.$white;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        transition: all 0.2s;
                    }

                    .custom-checkbox-input:checked+.custom-checkbox-visual {
                        background-color: variables.$white;
                        border-color: variables.$gray-700;

                        &::after {
                            content: '';
                            width: rem(10);
                            height: rem(10);
                            background-color: variables.$gray-700;
                        }
                    }

                    .label-text {
                        font-size: variables.$font-size-md;
                        color: variables.$gray-300;
                        line-height: 1; // 라인 높이 정렬
                        padding-top: rem(0); // 시각적 보정
                        margin-left: 0;
                    }
                }
            }
        }

        // 검색 제어 (전체 선택, 보기 옵션)
        .search-control-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: rem(10);
            padding-top: rem(10);
            padding-bottom: rem(24);
            border-bottom: 1.5px solid variables.$gray-100;

            .left-col {
                display: flex;
                align-items: center;
                gap: rem(12);

                .label {
                    font-size: variables.$font-size-md;

                    color: variables.$gray-700;
                }

                .input-wrap {
                    position: relative;

                    input {
                        width: rem(360);
                        height: rem(48);
                        background-color: #f8f8f8;
                        border: 1.5px solid transparent;
                        border-radius: variables.$space-xs;
                        padding: 0 variables.$space-md;
                        font-size: rem(15);
                        color: variables.$black;

                        &::placeholder {
                            color: variables.$gray-400;
                        }

                        &:focus {
                            outline: none;
                            border-color: variables.$gray-700;
                            background-color: variables.$white;
                        }
                    }
                }

                .btn-search {
                    height: rem(48);
                    padding: rem(10) variables.$space-md;
                    background: variables.$white;
                    border: 1.5px solid variables.$gray-700;
                    color: variables.$black;
                    font-size: rem(15);
                    border-radius: variables.$space-xs;
                    cursor: pointer;
                    white-space: nowrap;
                    min-width: max-content;
                    @include mixins.btn-hover-effect;
                }
            }

            .right-col {
                display: flex;
                align-items: center;
                gap: rem(12);

                .dropdown-wrapper {
                    min-width: rem(210); // 검색 결과 전용 크기 (Search result specific width)
                }

                .view-toggles {
                    display: flex;
                    align-items: center;

                    .btn-toggle {
                        width: rem(48); // 터치 영역 확장
                        height: rem(48);
                        border: none;
                        background: none;
                        padding: 0;
                        cursor: pointer;
                        color: variables.$gray-300;
                        @include mixins.btn-hover-effect;

                        &.active {
                            color: variables.$black;
                        }

                        svg {
                            width: rem(24);
                            height: rem(24);
                        }
                    }
                }
            }
        }
    }


    .tab-menu {
        .tab-item {
            font-size: variables.$font-size-lg;
            font-weight: 600;
            letter-spacing: rem(-0.4);
        }
    }

    // 그리드 시스템
    .product-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        // 기본 4열 그리드p: rem(24);
        row-gap: rem(60);
        margin-bottom: rem(80);
        margin-top: rem(40);

        .product-card-wrap {
            position: relative;

            .card-checkbox {
                position: absolute;
                top: rem(0);
                right: rem(0);
                z-index: 20;
            }
        }
    }

    .tab-menu {
        margin-bottom: variables.$space-lg;
    }

    .product-control-bar {
        display: flex;
        align-items: center;
        gap: variables.$space-lg;
        margin-bottom: variables.$space-lg;

        custom-checkbox {
            .custom-checkbox-wrap .label-text {
                color: variables.$gray-700 !important;
            }

            .label-text {
                margin-left: 0;
            }
        }

        .btn-add-selected {
            display: flex;
            align-items: center;
            justify-content: center;
            height: rem(48);
            padding: rem(10) variables.$space-md;
            background-color: variables.$white;
            border: 1.5px solid variables.$gray-700;
            border-radius: variables.$space-xs;
            font-size: variables.$font-size-md;
            font-weight: 600;
            color: variables.$gray-700;
            cursor: pointer;
            letter-spacing: rem(-0.32);

            &:hover {
                background-color: variables.$gray-50;
            }
        }
    }

    // 상품 카드 스타일 재정의
    .product-card {
        width: 100%;
        position: relative;


        .card-thumb {
            position: relative;
            display: block;
            margin-bottom: variables.$space-md;

            img {
                width: 100%;
                aspect-ratio: 1/1;
                object-fit: cover;
                border-radius: variables.$space-sm;
            }

            .card-checkbox {
                position: absolute;
                top: rem(12);
                right: rem(12);
                z-index: 20;
            }

            .status-overlay {
                display: none;
            }
        }

        .badge-bar {
            display: flex;
            gap: variables.$space-xs;
            margin-bottom: variables.$space-sm;
            flex-wrap: wrap;

            .badge {
                font-size: variables.$font-size-xs;
                padding: variables.$space-xs rem(6);
                border-radius: variables.$space-xs;

            }
        }

        .product-name {
            font-size: variables.$font-size-lg;
            font-weight: 600;
            color: variables.$black;
            margin-bottom: variables.$space-xs;
            line-height: 1.4;
            height: auto;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .price-info {
            .original {
                display: inline-block;
            }
        }

        // 품절/준비중 상태 (Dimmed)
        &.state-dimmed {
            a {
                cursor: default;
            }

            .card-thumb {
                &::after {
                    content: '';
                    position: absolute;
                    inset: 0;
                    background-color: rgba(0, 0, 0, 0.4);
                    z-index: 10;
                    border-radius: variables.$space-sm;
                }

                .status-overlay {
                    display: flex; // "품절" 등의 텍스트 표시
                    align-items: center;
                    justify-content: center;
                    flex-direction: column;
                    gap: rem(40);
                    position: absolute;
                    bottom: 5%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    z-index: 15;
                    width: 76%;
                    color: variables.$white;
                    font-size: rem(24);
                    font-weight: 600;

                    .btn-substitute {
                        flex: 1;
                        min-height: rem(48);
                        width: 100%;
                        background-color: variables.$white;
                        border: 1.5px solid variables.$gray-700;
                        border-radius: variables.$space-xs;
                        font-size: variables.$font-size-md;
                        color: variables.$gray-700;
                        cursor: pointer;
                        font-weight: 600;
                        display: flex;
                        align-items: center;
                        justify-content: center;

                        @include mixins.btn-hover-effect;
                    }
                }
            }

            .card-info {
                * {
                    color: variables.$gray-300 !important;
                }

                // 구체적인 색상 재정의 (!important 보완)
                .product-name,
                .price,
                .discount,
                .unit-highlight,
                .unit-desc,
                .unit-info span {
                    color: variables.$gray-300 !important;
                }
            }

            .card-control {
                display: flex;
                gap: variables.$space-sm;

                &.sold-out {

                    *:disabled,
                    .qty-box {
                        cursor: default;
                        background: variables.$gray-50;

                        &.btn-icon {
                            &:hover {
                                border-color: variables.$gray-200;
                            }
                        }
                    }

                    input,
                    svg:not(.icon-heart) {

                        color: variables.$gray-300;
                        pointer-events: none;

                        &:focus {
                            outline: none;
                        }
                    }
                }
            }
        }
    }

    // 리스트 보기 수정자
    .product-grid-4.list-view {
        // 컨테이너 그리드 레이아웃 덮어쓰기
        display: flex;
        flex-direction: column;
        gap: 0;
        border-top: 1.5px solid variables.$black; // 리스트 보기 상단 테두리

        .product-card {
            display: flex;
            flex-direction: row;
            align-items: center; // 수직 중앙 정렬
            width: 100%;
            padding: rem(20) rem(10);
            border-bottom: 1.5px solid variables.$gray-100;
            margin: 0;
            height: auto !important; // 고정 높이 초기화


            // 1. 썸네일 영역 (좌측)
            .card-thumb {
                width: rem(130) !important; // 3줄 텍스트/버튼 높이 맟춤
                height: rem(130) !important;
                flex-shrink: 0;
                margin: 0 variables.$space-lg 0 0 !important;
                padding: 0 !important;
                position: relative;
                border-radius: variables.$space-xs;
                background-color: transparent;

                // 종횡비 핵 비활성화
                &::before {
                    display: none !important;
                }

                img {
                    position: static !important;
                    transform: none !important;
                    // 너비 제한 (20개씩 보기)!important;
                    height: 100% !important;
                    object-fit: cover;
                    border-radius: variables.$space-xs;
                }

                // 리스트 뷰 체크박스 위치
                .card-checkbox {
                    top: rem(4);
                    right: rem(4);
                    // 그리드 위로 표시 (z-index)mportant; // 딤 오버레이(z-index 10) 위로 배치
                }

                // 뱃지는 숨기고 품절 상태 오버레이는 표시
                .badge-corner {
                    display: none !important;
                }

                .status-overlay {
                    // display: block !important; // 오버레이 텍스트 표시
                    font-size: variables.$font-size-base !important; // 리스트 뷰 썸네일용 작은 폰트
                    white-space: nowrap;
                    width: 100%;
                    text-align: center;
                }

                // 배송 태그 숨김 (요청사항)
                .delivery-tags {
                    display: none !important;
                }

                .status-overlay {
                    display: flex; // "품절" 등의 텍스트 표시
                    align-items: center;
                    justify-content: center;
                    flex-direction: column;
                    gap: variables.$space-md;
                    position: absolute;
                    bottom: -16%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    z-index: 15;
                    width: 76%;
                    color: variables.$white;
                    font-size: variables.$font-size-md;
                    font-weight: 600;

                    .btn-substitute {
                        flex: 1;
                        min-height: rem(38);
                        width: 100%;
                        background-color: variables.$white;
                        border: 1.5px solid variables.$gray-700;
                        border-radius: variables.$space-xs;
                        font-size: variables.$font-size-md;
                        color: variables.$gray-700;
                        cursor: pointer;
                        font-weight: 600;
                        display: flex;
                        align-items: center;
                        justify-content: center;

                        @include mixins.btn-hover-effect;
                    }
                }
            }

            // 2. 정보 영역 (중앙)
            .card-info {
                flex-grow: 1; // 남은 공간 차지
                display: flex;
                flex-direction: column;
                justify-content: center;
                margin: 0 !important;
                text-align: left;
                width: auto; // 너비 초기화

                .product-name {
                    font-size: rem(18); // 그리드보다 약간 작게
                    margin-bottom: variables.$space-sm;
                    -webkit-line-clamp: 1; // 한 줄 제목
                    line-height: normal;
                    height: auto;
                }

                .unit-info {
                    margin-bottom: variables.$space-xs;
                    font-size: variables.$font-size-base;
                }

                .total-price-area {
                    font-size: rem(20);
                }
            }

            // 3. 제어 영역 (우측)
            .card-control {
                flex-shrink: 0;
                width: auto; // 콘텐츠 맞춤
                margin: 0 0 0 variables.$space-lg !important;
                display: flex;
                flex-direction: row; // 제어 요소 가로 배치
                align-items: center;
                gap: variables.$space-sm;

                .qty-box {
                    width: rem(120); // 수량 입력란 고정 너비
                    height: rem(40);
                    display: flex;
                    align-items: center;
                    background-color: variables.$white;
                    border: 1.5px solid variables.$gray-200;
                    border-radius: variables.$space-xs;

                    button {
                        width: rem(32);
                        height: 100%;
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        border: none;
                        background: none;
                    }

                    input {
                        width: calc(100% - #{rem(64)});
                        height: calc(100% - rem(2)) !important;
                        border: none;
                        text-align: center;
                        font-size: rem(15);
                    }
                }

                // 아이콘
                .btn-icon {
                    width: rem(40);
                    height: rem(40);
                    margin: 0;
                    background-color: variables.$white;
                }

                // 대체 상품 버튼 유지
                .btn-substitute {
                    height: rem(40);
                    padding: 0 rem(16);
                    font-size: rem(14);
                }
            }

            // 하단 정보 숨김 (간결한 리스트)
            .bottom-info {
                display: none !important;
            }
        }

        .card-control {
            display: flex;
            gap: rem(8);

            &.sold-out {

                *:disabled,
                .qty-box {
                    cursor: default;
                    background: variables.$gray-50;

                    &.btn-icon {
                        &:hover {
                            border-color: variables.$gray-200;
                        }
                    }
                }

                input,
                svg:not(.icon-heart) {

                    color: variables.$gray-300;
                    pointer-events: none;

                    &:focus {
                        outline: none;
                    }
                }
            }
        }
    }

    // 공통 커스텀 체크박스 재사용
    .custom-checkbox-wrap {
        display: inline-flex;
        align-items: center;
        gap: variables.$space-sm;
        cursor: pointer;
        position: relative;
        user-select: none;

        .hidden-checkbox,
        .custom-checkbox-input {
            // 호환성 지원
            display: none;
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .custom-checkbox-ui,
        .custom-checkbox-visual {
            position: relative;
            width: variables.$font-size-lg;
            height: variables.$font-size-lg;
            display: inline-flex;
            align-items: center;
            justify-content: center;

            svg {
                width: 100%;
                height: 100%;
                display: block;
            }
        }

        .label-text {
            // margin-left: rem(6);
            font-size: variables.$font-size-md;
        }

    }




    // 검색 결과 그리드
    .product-grid-4 {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: variables.$space-lg;
        margin-top: variables.$space-md;

        &.list-view {
            grid-template-columns: 1fr; // 리스트 모드 (List View)
            gap: rem(12);

            .product-card {
                flex-direction: row;
                height: rem(180);
                padding: rem(20);
                gap: variables.$space-lg;
                align-items: center;
                border-bottom: 1px solid variables.$gray-200;

                .card-thumb {
                    width: rem(140);
                    height: rem(140);
                    flex-shrink: 0;

                    img {
                        width: 100%;
                        height: 100%;
                        object-fit: contain;
                    }
                }

                .card-info {
                    flex: 1;
                    padding: 0;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;

                    .product-name {
                        font-size: rem(18);
                        margin-bottom: variables.$space-xs;
                    }

                    .unit-info {
                        margin-top: 0;
                        margin-bottom: variables.$space-xs;
                    }

                    .total-price-area {
                        margin-top: 0;

                        .price {
                            font-size: variables.$font-size-xl;
                        }
                    }
                }

                .card-control {
                    // width: rem(120);
                    max-width: rem(240);
                    flex-direction: row;
                    gap: rem(12);
                    margin-top: 0;

                    .qty-box {
                        width: 100%;
                    }
                }

                .bottom-info {
                    display: none; // 리스트 뷰에서는 하단 정보 간소화
                }
            }
        }
    }

    // 페이지네이션
    .pagination-container {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: variables.$space-sm;
        margin-top: variables.$space-xxl;
        padding: 0;

        .pagination-nav-group {
            display: flex;
            align-items: center;
            gap: 0; // 간격 제거
        }

        .btn-pagination {
            display: flex;
            align-items: center;
            justify-content: center;
            width: rem(48);
            height: rem(48);
            background-color: variables.$white;
            border-radius: variables.$space-xs;
            font-size: variables.$font-size-md;
            font-weight: 600;
            color: variables.$gray-700; // 피그마 텍스트 색상
            cursor: pointer;
            text-decoration: none;
            transition: background-color 0.2s, color 0.2s;
            font-family: 'Pretendard', sans-serif;
            letter-spacing: -0.02em;
            line-height: 1.5;

            // 기본 버튼 스타일 초기화
            border: none;
            padding: 0;

            &:hover {
                background-color: variables.$gray-50;
            }

            &.active {
                background-color: variables.$gray-700;
                color: variables.$white;
            }

            svg {
                width: rem(20);
                height: rem(20);
                fill: currentColor;

                path {
                    fill: currentColor;
                }
            }
        }
    }
}